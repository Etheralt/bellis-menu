<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js';
        import { getFirestore, collection, addDoc, updateDoc, doc } from 'https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDE-ALjM_E3gCpyH3_rbMz2u-hEFJ8nO2c",
            authDomain: "bellis-menu.firebaseapp.com",
            projectId: "bellis-menu",
            storageBucket: "bellis-menu.firebasestorage.app",
            messagingSenderId: "1765826468",
            appId: "1:1765826468:web:73115f5b5f910d89c16b31"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Check if the user is authenticated
        onAuthStateChanged(auth, (user) => {
            if (!user) {
                window.location.href = "login.html"; // Redirect to login if not authenticated
            }
        });

        function logout() {
            signOut(auth)
                .then(() => {
                    window.location.href = "login.html";
                })
                .catch((error) => {
                    alert("Logout failed: " + error.message);
                });
        }

        async function addMenuItem() {
            const itemName = document.getElementById("itemName").value;
            const description = document.getElementById("description").value;
            const imageURL = document.getElementById("imageURL").value;

            if (!itemName || !description || !imageURL) {
                alert("Please fill in all fields");
                return;
            }

            try {
                const docRef = await addDoc(collection(db, "coffees"), {
                    description: description,
                    imageURL: imageURL
                });

                alert("Item added successfully!");
                document.getElementById("itemName").value = "";
                document.getElementById("description").value = "";
                document.getElementById("imageURL").value = "";
            } catch (e) {
                alert("Error adding document: " + e);
            }
        }
    </script>
</head>
<body>
    <h1>Admin Panel</h1>
    <button onclick="logout()">Logout</button>

    <h2>Add New Menu Item</h2>
    <label for="itemName">Item Name:</label>
    <input type="text" id="itemName">
    <label for="description">Description:</label>
    <input type="text" id="description">
    <label for="imageURL">Image URL:</label>
    <input type="text" id="imageURL">
    <button onclick="addMenuItem()">Add Item</button>
</body>
</html>
